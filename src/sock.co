{EventEmitter} = require \events

class Sock extends EventEmitter
  (@ws) ->
    @ <<<< ws.request.query{ id, name, room }
    ws.on \message ~> @emit ...JSON.parse it
    ws.on \close   ~> @emit \drop

  send: (name, args) ->
    @ws.send JSON.stringify { name, args }

module.exports = Sock
