request = require \request
{rand} = require \./_

db = (data) ->
  options = {} <<<< couch

  # sequential ids for extreme performance
  data._id = data.end + rand 1e9 .toString 16 .slice -6
  options.uri += data._id
  options.json = data

  request options, (err, res, body) ->
    if err
      console.log 'couch err' that

try
  couch = require \../data/couch
catch
  console.log 'data/couch.json not found'
  db = ->

module.exports = db
